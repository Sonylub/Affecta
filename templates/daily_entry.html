{% extends "base.html" %}

{% block title %}–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –∑–∞–ø–∏—Å—å - –°—Ç–∞–±–∏–ª{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <div class="text-center mb-8">
        <h1 class="text-3xl font-bold text-gray-900 dark:text-white mb-2">
            –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –∑–∞–ø–∏—Å—å
        </h1>
        <p class="text-lg text-gray-600 dark:text-gray-400">
            {{ today|date("d.m.Y") }} - 
            {% if entry %}
                –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∑–∞–ø–∏—Å–∏
            {% else %}
                –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∑–∞–ø–∏—Å–∏
            {% endif %}
        </p>
    </div>
    
    <!-- –§–æ—Ä–º–∞ –∑–∞–ø–∏—Å–∏ -->
    <form method="POST" class="space-y-8">
        <!-- –û—Å–Ω–æ–≤–Ω—ã–µ —à–∫–∞–ª—ã -->
        <div class="bg-white dark:bg-gray-800 rounded-xl p-6 card-shadow">
            <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-6">
                –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (0-10)
            </h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">
                        –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ
                    </label>
                    <div class="relative">
                        <input type="range" name="mood" id="mood" min="0" max="10" 
                               value="{{ entry.mood if entry and entry.mood is not none else '5' }}"
                               class="w-full h-2 slider-track rounded-lg appearance-none cursor-pointer">
                        <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-2">
                            <span>0 - –û—á–µ–Ω—å –ø–ª–æ—Ö–æ</span>
                            <span id="moodValue">{{ entry.mood if entry and entry.mood is not none else '5' }}</span>
                            <span>10 - –û—Ç–ª–∏—á–Ω–æ</span>
                        </div>
                    </div>
                </div>
                
                <!-- –¢—Ä–µ–≤–æ–≥–∞ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">
                        –¢—Ä–µ–≤–æ–≥–∞
                    </label>
                    <div class="relative">
                        <input type="range" name="anxiety" id="anxiety" min="0" max="10" 
                               value="{{ entry.anxiety if entry and entry.anxiety is not none else '5' }}"
                               class="w-full h-2 slider-track rounded-lg appearance-none cursor-pointer">
                        <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-2">
                            <span>0 - –ù–µ—Ç —Ç—Ä–µ–≤–æ–≥–∏</span>
                            <span id="anxietyValue">{{ entry.anxiety if entry and entry.anxiety is not none else '5' }}</span>
                            <span>10 - –°–∏–ª—å–Ω–∞—è —Ç—Ä–µ–≤–æ–≥–∞</span>
                        </div>
                    </div>
                </div>
                
                <!-- –≠–Ω–µ—Ä–≥–∏—è -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">
                        –≠–Ω–µ—Ä–≥–∏—è
                    </label>
                    <div class="relative">
                        <input type="range" name="energy" id="energy" min="0" max="10" 
                               value="{{ entry.energy if entry and entry.energy is not none else '5' }}"
                               class="w-full h-2 slider-track rounded-lg appearance-none cursor-pointer">
                        <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-2">
                            <span>0 - –ü–æ–ª–Ω–æ–µ –∏—Å—Ç–æ—â–µ–Ω–∏–µ</span>
                            <span id="energyValue">{{ entry.energy if entry and entry.energy is not none else '5' }}</span>
                            <span>10 - –ú–∞–∫—Å–∏–º—É–º —ç–Ω–µ—Ä–≥–∏–∏</span>
                        </div>
                    </div>
                </div>
                
                <!-- –†–∞–∑–¥—Ä–∞–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">
                        –†–∞–∑–¥—Ä–∞–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
                    </label>
                    <div class="relative">
                        <input type="range" name="irritability" id="irritability" min="0" max="10" 
                               value="{{ entry.irritability if entry and entry.irritability is not none else '5' }}"
                               class="w-full h-2 slider-track rounded-lg appearance-none cursor-pointer">
                        <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-2">
                            <span>0 - –°–ø–æ–∫–æ–µ–Ω</span>
                            <span id="irritabilityValue">{{ entry.irritability if entry and entry.irritability is not none else '5' }}</span>
                            <span>10 - –û—á–µ–Ω—å —Ä–∞–∑–¥—Ä–∞–∂–µ–Ω</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –°–æ–Ω -->
        <div class="bg-white dark:bg-gray-800 rounded-xl p-6 card-shadow">
            <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-6">
                –°–æ–Ω
            </h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- –ß–∞—Å—ã —Å–Ω–∞ -->
                <div>
                    <label for="sleep_hours" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                        –°–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤ –≤—ã —Å–ø–∞–ª–∏?
                    </label>
                    <input type="number" name="sleep_hours" id="sleep_hours" step="0.5" min="0" max="24"
                           value="{{ entry.sleep_hours if entry and entry.sleep_hours is not none else '' }}"
                           class="appearance-none block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                           placeholder="8.0">
                </div>
                
                <!-- –ö–∞—á–µ—Å—Ç–≤–æ —Å–Ω–∞ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">
                        –ö–∞—á–µ—Å—Ç–≤–æ —Å–Ω–∞
                    </label>
                    <div class="relative">
                        <input type="range" name="sleep_quality" id="sleep_quality" min="1" max="10" 
                               value="{{ entry.sleep_quality if entry and entry.sleep_quality is not none else '5' }}"
                               class="w-full h-2 slider-track rounded-lg appearance-none cursor-pointer">
                        <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-2">
                            <span>1 - –£–∂–∞—Å–Ω–æ</span>
                            <span id="sleepQualityValue">{{ entry.sleep_quality if entry and entry.sleep_quality is not none else '5' }}</span>
                            <span>10 - –û—Ç–ª–∏—á–Ω–æ</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –¢–∏–ø –¥–Ω—è -->
        <div class="bg-white dark:bg-gray-800 rounded-xl p-6 card-shadow">
            <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-6">
                –¢–∏–ø –¥–Ω—è
            </h2>
            
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <label class="relative">
                    <input type="radio" name="day_type" value="normal" 
                           {% if entry and entry.day_type == 'normal' %}checked{% endif %}
                           class="sr-only peer">
                    <div class="p-4 border-2 border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer peer-checked:border-blue-500 peer-checked:bg-blue-50 dark:peer-checked:bg-blue-900/20 transition-all">
                        <div class="text-center">
                            <div class="text-2xl mb-2">üòä</div>
                            <div class="text-sm font-medium text-gray-700 dark:text-gray-300">
                                –ù–æ—Ä–º–∞–ª—å–Ω—ã–π
                            </div>
                        </div>
                    </div>
                </label>
                
                <label class="relative">
                    <input type="radio" name="day_type" value="manic" 
                           {% if entry and entry.day_type == 'manic' %}checked{% endif %}
                           class="sr-only peer">
                    <div class="p-4 border-2 border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer peer-checked:border-yellow-500 peer-checked:bg-yellow-50 dark:peer-checked:bg-yellow-900/20 transition-all">
                        <div class="text-center">
                            <div class="text-2xl mb-2">‚ö°</div>
                            <div class="text-sm font-medium text-gray-700 dark:text-gray-300">
                                –ú–∞–Ω–∏–∞–∫–∞–ª—å–Ω—ã–π
                            </div>
                        </div>
                    </div>
                </label>
                
                <label class="relative">
                    <input type="radio" name="day_type" value="depressive" 
                           {% if entry and entry.day_type == 'depressive' %}checked{% endif %}
                           class="sr-only peer">
                    <div class="p-4 border-2 border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer peer-checked:border-gray-500 peer-checked:bg-gray-50 dark:peer-checked:bg-gray-900/20 transition-all">
                        <div class="text-center">
                            <div class="text-2xl mb-2">üòî</div>
                            <div class="text-sm font-medium text-gray-700 dark:text-gray-300">
                                –î–µ–ø—Ä–µ—Å—Å–∏–≤–Ω—ã–π
                            </div>
                        </div>
                    </div>
                </label>
                
                <label class="relative">
                    <input type="radio" name="day_type" value="mixed" 
                           {% if entry and entry.day_type == 'mixed' %}checked{% endif %}
                           class="sr-only peer">
                    <div class="p-4 border-2 border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer peer-checked:border-purple-500 peer-checked:bg-purple-50 dark:peer-checked:bg-purple-900/20 transition-all">
                        <div class="text-center">
                            <div class="text-2xl mb-2">üå™Ô∏è</div>
                            <div class="text-sm font-medium text-gray-700 dark:text-gray-300">
                                –°–º–µ—à–∞–Ω–Ω—ã–π
                            </div>
                        </div>
                    </div>
                </label>
            </div>
        </div>
        
        <!-- –ú–µ–¥–∏–∫–∞–º–µ–Ω—Ç—ã -->
        {% if medications %}
        <div class="bg-white dark:bg-gray-800 rounded-xl p-6 card-shadow">
            <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-6">
                –ú–µ–¥–∏–∫–∞–º–µ–Ω—Ç—ã
            </h2>
            
            <div class="space-y-4">
                {% for medication in medications %}
                <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                    <div>
                        <div class="font-medium text-gray-900 dark:text-white">
                            {{ medication.name }}
                        </div>
                        <div class="text-sm text-gray-600 dark:text-gray-400">
                            {{ medication.dosage }} - {{ medication.frequency }}
                        </div>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" name="medication_{{ medication.id }}" 
                               {% if entry and entry.medications_taken %}checked{% endif %}
                               class="focus:ring-blue-500 h-5 w-5 text-blue-600 border-gray-300 dark:border-gray-600 rounded">
                        <label class="ml-2 text-sm text-gray-700 dark:text-gray-300">
                            –ü—Ä–∏–Ω—è—Ç–æ
                        </label>
                    </div>
                </div>
                {% endfor %}
                
                <div class="flex items-center">
                    <input type="checkbox" name="medications_taken" id="medications_taken" 
                           {% if entry and entry.medications_taken %}checked{% endif %}
                           class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 dark:border-gray-600 rounded">
                    <label for="medications_taken" class="ml-2 block text-sm text-gray-700 dark:text-gray-300">
                        –í—Å–µ –º–µ–¥–∏–∫–∞–º–µ–Ω—Ç—ã –ø—Ä–∏–Ω—è—Ç—ã
                    </label>
                </div>
            </div>
        </div>
        {% endif %}
        
        <!-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ç—Ä–µ–∫–µ—Ä—ã -->
        {% if custom_trackers %}
        <div class="bg-white dark:bg-gray-800 rounded-xl p-6 card-shadow">
            <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-6">
                –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
            </h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                {% for tracker in custom_trackers %}
                <div>
                    <label for="custom_{{ tracker.id }}" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                        {{ tracker.name }}
                        {% if tracker.unit %}
                        <span class="text-xs text-gray-500 dark:text-gray-400">({{ tracker.unit }})</span>
                        {% endif %}
                    </label>
                    
                    {% if tracker.type == 'slider' %}
                    <div class="relative">
                        <input type="range" name="custom_{{ tracker.id }}" id="custom_{{ tracker.id }}" 
                               min="{{ tracker.min_value }}" max="{{ tracker.max_value }}" 
                               value="{% if entry and entry.custom_values and tracker.id|string in entry.custom_values %}{{ entry.custom_values[tracker.id|string] }}{% else %}{{ (tracker.max_value - tracker.min_value) // 2 + tracker.min_value }}{% endif %}"
                               class="w-full h-2 rounded-lg appearance-none cursor-pointer"
                               style="background: linear-gradient(to right, {{ tracker.color }}33, {{ tracker.color }});">
                        <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-2">
                            <span>{{ tracker.min_value }}</span>
                            <span id="custom_{{ tracker.id }}_value">
                                {% if entry and entry.custom_values and tracker.id|string in entry.custom_values %}
                                    {{ entry.custom_values[tracker.id|string] }}
                                {% else %}
                                    {{ (tracker.max_value - tracker.min_value) // 2 + tracker.min_value }}
                                {% endif %}
                            </span>
                            <span>{{ tracker.max_value }}</span>
                        </div>
                    </div>
                    
                    {% elif tracker.type == 'checkbox' %}
                    <div class="flex items-center">
                        <input type="checkbox" name="custom_{{ tracker.id }}" id="custom_{{ tracker.id }}" 
                               {% if entry and entry.custom_values and tracker.id|string in entry.custom_values and entry.custom_values[tracker.id|string] %}checked{% endif %}
                               class="focus:ring-blue-500 h-5 w-5 text-blue-600 border-gray-300 dark:border-gray-600 rounded"
                               style="accent-color: {{ tracker.color }};">
                        <label for="custom_{{ tracker.id }}" class="ml-2 text-sm text-gray-700 dark:text-gray-300">
                            {{ tracker.description or '–í–∫–ª—é—á–∏—Ç—å' }}
                        </label>
                    </div>
                    
                    {% elif tracker.type == 'number' %}
                    <input type="number" name="custom_{{ tracker.id }}" id="custom_{{ tracker.id }}"
                           value="{% if entry and entry.custom_values and tracker.id|string in entry.custom_values %}{{ entry.custom_values[tracker.id|string] }}{% endif %}"
                           class="appearance-none block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                           placeholder="0">
                    
                    {% elif tracker.type == 'text' %}
                    <input type="text" name="custom_{{ tracker.id }}" id="custom_{{ tracker.id }}"
                           value="{% if entry and entry.custom_values and tracker.id|string in entry.custom_values %}{{ entry.custom_values[tracker.id|string] }}{% endif %}"
                           class="appearance-none block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                           placeholder="{{ tracker.default_value or '–í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ' }}">
                    {% endif %}
                    
                    {% if tracker.description and tracker.type != 'checkbox' %}
                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">{{ tracker.description }}</p>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        
        <!-- –ü—Ä–∏–º–µ—á–∞–Ω–∏—è -->
        <div class="bg-white dark:bg-gray-800 rounded-xl p-6 card-shadow">
            <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">
                –ü—Ä–∏–º–µ—á–∞–Ω–∏—è
            </h2>
            
            <div>
                <label for="notes" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                    –ó–∞–º–µ—Ç–∫–∏ –æ –¥–Ω–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
                </label>
                <textarea name="notes" id="notes" rows="4"
                          class="appearance-none block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                          placeholder="–û–ø–∏—à–∏—Ç–µ —Å–≤–æ–π –¥–µ–Ω—å, –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è, –º—ã—Å–ª–∏ –∏ —á—É–≤—Å—Ç–≤–∞...">{{ entry.notes if entry else '' }}</textarea>
            </div>
        </div>
        
        <!-- –ö–Ω–æ–ø–∫–∏ -->
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <button type="submit" 
                    class="inline-flex items-center px-8 py-3 border border-transparent text-base font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                </svg>
                {% if entry %}–û–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å{% else %}–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å{% endif %}
            </button>
            
            <a href="{{ url_for('dashboard') }}" 
               class="inline-flex items-center px-8 py-3 border border-gray-300 dark:border-gray-600 text-base font-medium rounded-lg text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                </svg>
                –û—Ç–º–µ–Ω–∞
            </a>
        </div>
    </form>
</div>
{% endblock %}

{% block scripts %}
<script>
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π —Å–ª–∞–π–¥–µ—Ä–æ–≤
    function updateSliderValues() {
        const sliders = document.querySelectorAll('input[type="range"]');
        
        sliders.forEach(slider => {
            const valueSpan = document.getElementById(slider.id + 'Value');
            if (valueSpan) {
                valueSpan.textContent = slider.value;
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
            slider.addEventListener('input', function() {
                if (valueSpan) {
                    valueSpan.textContent = this.value;
                }
            });
        });
    }
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    document.addEventListener('DOMContentLoaded', function() {
        updateSliderValues();
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–µ–¥–∏–∫–∞–º–µ–Ω—Ç–æ–≤
        const medicationCheckboxes = document.querySelectorAll('input[name^="medication_]');
        const allMedicationsCheckbox = document.getElementById('medications_taken');
        
        function updateAllMedications() {
            const allChecked = Array.from(medicationCheckboxes).every(cb => cb.checked);
            allMedicationsCheckbox.checked = allChecked;
        }
        
        medicationCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', updateAllMedications);
        });
        
        allMedicationsCheckbox.addEventListener('change', function() {
            medicationCheckboxes.forEach(checkbox => {
                checkbox.checked = this.checked;
            });
        });
        
        // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã
        document.querySelector('form').addEventListener('submit', function(e) {
            const mood = document.getElementById('mood').value;
            const anxiety = document.getElementById('anxiety').value;
            const energy = document.getElementById('energy').value;
            const irritability = document.getElementById('irritability').value;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —à–∫–∞–ª
            if (!mood || !anxiety || !energy || !irritability) {
                e.preventDefault();
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ, —Ç—Ä–µ–≤–æ–≥–∞, —ç–Ω–µ—Ä–≥–∏—è, —Ä–∞–∑–¥—Ä–∞–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–∞—Å–æ–≤ —Å–Ω–∞
            const sleepHours = document.getElementById('sleep_hours').value;
            if (sleepHours && (sleepHours < 0 || sleepHours > 24)) {
                e.preventDefault();
                alert('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Å–æ–≤ —Å–Ω–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç 0 –¥–æ 24');
                return;
            }
        });
        
        // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–Ω–æ–≤–∏–∫–∞
        let saveTimeout;
        const form = document.querySelector('form');
        
        form.addEventListener('input', function() {
            clearTimeout(saveTimeout);
            saveTimeout = setTimeout(() => {
                // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                console.log('–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...');
            }, 30000); // 30 —Å–µ–∫—É–Ω–¥
        });
    });
    
    // –ë—ã—Å—Ç—Ä–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –∫–ª–∞–≤–∏—à–∞–º–∏
    document.addEventListener('keydown', function(e) {
        // Ctrl/Cmd + S –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
        if ((e.ctrlKey || e.metaKey) && e.key === 's') {
            e.preventDefault();
            document.querySelector('button[type="submit"]').click();
        }
        
        // Escape –¥–ª—è –æ—Ç–º–µ–Ω—ã
        if (e.key === 'Escape') {
            window.location.href = '{{ url_for('dashboard') }}';
        }
    });
</script>
{% endblock %}